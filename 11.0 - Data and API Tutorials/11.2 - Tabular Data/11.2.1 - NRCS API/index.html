<!DOCTYPE html>
<html lang = "en">

    <head>
    
        <meta charset = "UTF-8" />
        <meta name = "viewport" content = "width=device-width,initial-scale=1.0" />
        <meta http-equiv = "X-UA-Compatible" content = "ie=edge" />
        <title>NRCS Reporting Stations and Basins</title>
        <script
        src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
        integrity="sha256-pasqAKBDmFT4eHoN2ndd6lN370kFiGUFyTiUHWhU7k8="
        crossorigin="anonymous"></script>
        <script src = "https://cdn.jsdelivr.net/npm/chart.js@2.8.0/dist/Chart.min.js"></script>
    
    </head>

    <body>
        
                <h1>NRCS Snow Monitoring Stations and Basins</h1>

        <div id="main">

        <table id="table">
        <tr>
        
        <th>Site Name</th>
        <th>Code</th>
        <th>Elevation</th>
        <th>Latitutde</th>
        <th>Longitude</th>
        <th>Year</th>
        <th>County</th>
        
        </tr>
        
        
        
        </table>
        
        </div>
        <script>
            site_list = []
            async function getData(){
            
                //get response stream from loading csv
                const response = await fetch('data/NRCSsites.csv');
                
                //when response received, assign text of the response to data
                const data = await response.text();
                
                //parse data with split, remove first row (header)
                const rows = data.split('\n').slice(1);
                
                //iterate over rows
                rows.forEach(elt =>{
                    
                    //split each row at the comma
                    const row = elt.split(',');
                    
                    //assign each column to a variable in order from 0-6 for table display
                    
                    const name = row[0];
                    
                    const code = row[1];
                    
                    const elev = row[2];
                    
                    const lat = row[3];

                    const long = row[4];
                    
                    const year = row[5];
                    
                    const county = row[6];
                    
                    //display on page with dynamic table elements
                    //get this working then refactor
                    document.getElementById('table').innerHTML += ('<tr><td><button id=\"' + code + '\" onClick = \"reply_click(this.id)\">' + name + '</button></td><td>' + code + '</td><td>' + elev + '</td><td>' + lat + '</td><td>' + long + '</td><td>' + year +'</td><td>' + county +'</td></tr>');
            
                    //create list of sites and codes
                    site_list.push({site_name: name,
                    site_code: code});
                    
            
                });
                
                      
            
            };
        
            //execute function to parse data and display on page
            getData();
        
     
            //function called by button click, assign code for station as clicked_id
            function reply_click(clicked_id){
                console.log(clicked_id + " Was Clicked");
                checkName(site_list, clicked_id);
            };
            
            function checkName(site_list, clicked_id){
            
 


const result = site_list.find( fruit => site_list.site_name === clicked_id );

console.log(result.site_name) 
console.log(result.site_code) 
            
            };
                
            
            
 
        </script>


<style>

th{

    text-align: center;
    font-size: 1.5rem;
    border-bottom: .5rem solid black;
}


td{

    padding: .5rem;
    border: 1px solid gray;
    text-align: center;
}

button{

    min-width: 10rem;
}
li{

    list-style: none;
    text-decoration: none;
}

h1{

    text-align: center;

}


#main{
    display: flex;
    align-content: center;
    justify-content: center;


}


</style>

       
</body>

</html>