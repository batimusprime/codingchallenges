# NRCS Snow Data Graphing
## Hosted at: [https://nrcsgraphs.web.app/](https://nrcsgraphs.web.app/)
## Overview of Operations:

-----

### /data/:
    - NRCSsites.csv
        - main csv file to be scraped for charting data
    - 289 [site_code].csv files, containing all historical data for each site or basin

### /js/firebase-init.js:
    - contains variables for firebase config used for Firebase initialization
    
### /js/graph.js:

        - get site variables from URL passed (getSite())
        - get data from local folder (getData())
        - parse data* 
            *Data is only parsed via static line removal
        - chart data (chartIt())
        - After viewing, return to station list / admin page (back button)
    
### /js/main.js:
    
        - Display list of station information with clickable names
        - Click creates url with station code in appropriate location
        - Variables passed via URL to graph.html
    
### /js/options.js:
        - Dynamically set options for graph
        - Establish empty containers for data (will remove with Firebase integration)
        
### /logs/:
    - log_[YYYY-MM-DD].txt
        - as of now, only records retrieve operations

#### /py/main.py:
    -   get site code from site_list
        -   site_list restricted to 2 entries for development
    -   construct URI with site code
    -   add URI to uri_list
    -   for each uri send web request
    -   save response text as CSV
    -   log operations, close files
    
### HTML Pages:
-----
#### index.html:
    - Dynamically generated table of sites (289 sites)
    - Name, Code, Eleveation, Latitude, Longitude, Year, County for each
    - Button click sends code and name to graph.html
    
#### graph.html:
    - Dynamically generated chart from chart.JS
    - Parameters passed automatically via URL substring
    - Chart.JS parameters called and placed into canvas element on page
    
### Data
-----
___All data provided by NRCS___
* SWE = Snow Water Equivalent
>Depth of water that would theoretically result if the entire snowpack were melted instantaneously 

* List of stations:
    * https://wcc.sc.egov.usda.gov/nwcc/rgrpt?report=snowmonth_hist&state=CA&operation=View
* Link for reports:
    * https://wcc.sc.egov.usda.gov/reportGenerator/view_csv/customMultiTimeSeriesGroupByStationReport/monthly/start_of_period/ABY:CA:SNOW%7Cid=%22%22%7Cname/POR_BEGIN,POR_END/WTEQ::value?fitToScreen=false
* 289 Data files [site_code].csv, automatically generated by getdata.ipynb (Jupyter Notebook) or main.py (Python 3) 

### JavaScript
-----
#### Firebase-init.js:
    - Contains variables for Firebase configuration, kept separate so as to not publish to repo
    - Added to .gitignore
- How to re-create locally: 
[Understand Firebase projects](https://firebase.google.com/docs/projects/learn-more#config-files-objects)
    
```javascript
const firebaseConfig = {
        
        apiKey: "api-key",
        
        authDomain: "project-id.firebaseapp.com",
        
        databaseURL: "https://project-id.firebaseio.com",
        
        projectId: "project-id",
        
        storageBucket: "project-id.appspot.com",
        
        messagingSenderId: "sender-id",
        
        appID: "app-id",

    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
 
```
## Dependencies
* Firebase 6.2.4 (Delivered via CDN)
* Chart.js 2.8.0+ (Delivered via CDN)
* [ES6 supported browser](https://caniuse.com/#feat=es6)
* Python 3.6.4
* BeautifulSoup 4
* Urllib

---

---

## TODO
- [x] Get title from index.html and transfer to graph.html
- [ ] Last updated date
- [x] Fetch data with Python
- [ ] Parse and clean data with regex
- [ ] Set Fetch to CRON job 1x /  month
- [X] Hosting
- [ ] Expand to other states
- [x] Check for zero data years
- [ ] Display information about site with link to data in NRCSsites.csv
- [ ] Graphics
- [ ] Project details on website
- [ ] Node App
- [ ] Sortable stats: 
    - years w/ x inches
    - display zeroes
- [ ] Changeable types
- [ ] Toggle colors
- [ ] Significant events by year a.k.a. Sand County presentation method
- [ ] Push sweData and labels to Firebase