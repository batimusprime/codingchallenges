# NRCS Snow Data Graphing
## Hosted at: [https://nrcsgraphs.web.app/](https://nrcsgraphs.web.app/)
## Overview of Operations:

### Python: 
-----
#### /py/main.py:
    -   get site code from site_list
        -   site_list restricted to 2 entries for development
    -   construct URI with site code
    -   add URI to uri_list
    -   for each uri send web request
    -   save request as CSV
    -   log operations, close files
### /data/:
    - NRCSsites.csv
        - main csv file to be scraped for charting data
    - 289 [site_code].csv files, containing all historical data for each site or basin
### /logs/:
    - log_[Y-M-D].txt
        - as of now, only records retrieve operations
### HTML Pages:
-----
#### index.html:
    -   Display list of station information with clickable names
    - Click creates url with station code in appropriate location
    - variables passed via URL to graph.html
#### graph.html:
    - get site variables from URL passed (getSite())
    - get data from local folder (getData())
    - parse data* 
        *Data is only parsed via static line removal
    - chart data (chartIt())
    - After viewing, return to station list / admin page (back button)

### Data
-----
___All data provided by NRCS___
* List of stations:
    * https://wcc.sc.egov.usda.gov/nwcc/rgrpt?report=snowmonth_hist&state=CA&operation=View
* Link for reports:
    * https://wcc.sc.egov.usda.gov/reportGenerator/view_csv/customGroupByMonthReport/monthly/ABY:CA:SNOW%7Cid=%22%22%7Cname/POR_BEGIN,POR_END:1,2,3,4,5,6/WTEQ::collectionDate,SNWD::value,WTEQ::value
* 289 Data files [site_code].csv, automatically generated by getdata.ipynb (Jupyter Notebook) or main.py (Python 3) 

### JS
-----
#### Firebase-init.js:
    - contains variables for Firebase configuration, kept separate so as to not publish to repo. Added to .gitignore
- How to re-create locally: 
[Understand Firebase projects](https://firebase.google.com/docs/projects/learn-more#config-files-objects)
    
```javascript
const firebaseConfig = {
        
        apiKey: "api-key",
        
        authDomain: "project-id.firebaseapp.com",
        
        databaseURL: "https://project-id.firebaseio.com",
        
        projectId: "project-id",
        
        storageBucket: "project-id.appspot.com",
        
        messagingSenderId: "sender-id",
        
        appID: "app-id",

    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
 
```

#### Graph.js:
    - Required by graph.html, contains chart parameters
#### script.js:
    - Required by index.html, gathers site codes and displays in table
    
## Dependencies
* Firebase 6.2.4
* Chart.js 2.8.0+ (Delivered via CDN)
* [ES6 supported browser](https://caniuse.com/#feat=es6)
* Python 3.6.4
* BeautifulSoup 4
* Urllib

## TODO
- [x] Get title from index.html and transfer to graph.html
- [ ] Last updated date
- [x] Fetch data with Python
- [ ] Parse and clean data with regex
- [ ] Set Fetch to CRON job 1x /  month
- [X] Hosting
- [ ] Expand to other states
- [ ] Check for zero data years
- [ ] Display information about site with link to data in NRCSsites.csv
- [ ] Graphics
- [ ] Project details on website
